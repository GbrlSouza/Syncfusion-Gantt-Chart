<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Syncfusion Gantt Chart</title>
  <script src="https://cdn.syncfusion.com/ej2/20.3.56/dist/ej2.min.js"></script>
  <link rel="stylesheet" href="https://cdn.syncfusion.com/ej2/20.3.56/material.css">
</head>

<body>
  <div id="gantt" style="margin: 50px;"></div>
  <script>
    async function fetchTasks() {
      const response = await fetch('/tasks');
      return await response.json();
    }

    async function initGantt() {
      const tasks = await fetchTasks();
      const ganttData = tasks.map(task => ({
        TaskID: task.id,
        TaskName: task.name,
        StartDate: new Date(task.start_date),
        EndDate: new Date(task.end_date),
        Progress: parseFloat(task.progress)
      }));

      new ej.gantt.Gantt({
        dataSource: ganttData,
        height: '450px',
        taskFields: {
          id: 'TaskID',
          name: 'TaskName',
          startDate: 'StartDate',
          endDate: 'EndDate',
          progress: 'Progress'
        },
        toolbar: ['Add', 'Edit', 'Delete', 'Update', 'Cancel'],
      }).appendTo('#gantt');
    }

    initGantt();
  </script>
</body>

</html>